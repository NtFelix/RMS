(()=>{var e={};e.id=323,e.ids=[323],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},15264:(e,n,r)=>{"use strict";r.r(n),r.d(n,{default:()=>k});var s=r(60687),t=r(43210),i=r(55192),l=r(24934),a=r(1303),o=r(68988),d=r(99270);function c({onFilterChange:e,onSearchChange:n}){let[r,i]=(0,t.useState)("all"),a=n=>{i(n),e(n)};return(0,s.jsx)("div",{className:"flex flex-col gap-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(l.$,{variant:"all"===r?"default":"outline",onClick:()=>a("all"),className:"h-9",children:"Alle Mieter"}),(0,s.jsx)(l.$,{variant:"current"===r?"default":"outline",onClick:()=>a("current"),className:"h-9",children:"Aktuelle Mieter"}),(0,s.jsx)(l.$,{variant:"previous"===r?"default":"outline",onClick:()=>a("previous"),className:"h-9",children:"Vorherige Mieter"})]}),(0,s.jsxs)("div",{className:"relative w-full sm:w-auto sm:min-w-[300px]",children:[(0,s.jsx)(d.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(o.p,{type:"search",placeholder:"Mieter suchen...",className:"pl-8",onChange:e=>n(e.target.value)})]})]})})}var h=r(96752),u=r(15973),m=r(63143),x=r(88233),p=r(95033),j=r(70333);function g({children:e,tenant:n,onEdit:r,onRefresh:i}){let[l,a]=t.useState(!1),[o,d]=t.useState(!1),c=async()=>{try{if(d(!0),!(await fetch(`/api/mieter?id=${n.id}`,{method:"DELETE"})).ok)throw Error("Fehler beim L\xf6schen des Mieters");(0,j.oR)({title:"Erfolg",description:`Der Mieter "${n.name}" wurde erfolgreich gel\xf6scht.`}),i()}catch(e){console.error("Fehler beim L\xf6schen des Mieters:",e),(0,j.oR)({title:"Fehler",description:"Der Mieter konnte nicht gel\xf6scht werden. Bitte versuchen Sie es sp\xe4ter erneut.",variant:"destructive"})}finally{d(!1),a(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(u.tz,{children:[(0,s.jsx)(u.Rc,{asChild:!0,children:e}),(0,s.jsxs)(u.Ip,{className:"w-64",children:[(0,s.jsxs)(u.kt,{onClick:r,className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)(m.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Bearbeiten"})]}),(0,s.jsx)(u.K5,{}),(0,s.jsxs)(u.kt,{onClick:()=>a(!0),className:"flex items-center gap-2 cursor-pointer text-red-600 focus:text-red-600",children:[(0,s.jsx)(x.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"L\xf6schen"})]})]})]}),(0,s.jsx)(p.Lt,{open:l,onOpenChange:a,children:(0,s.jsxs)(p.EO,{children:[(0,s.jsxs)(p.wd,{children:[(0,s.jsx)(p.r7,{children:"Mieter l\xf6schen?"}),(0,s.jsxs)(p.$v,{children:['M\xf6chten Sie den Mieter "',n.name,'" wirklich l\xf6schen? Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden.']})]}),(0,s.jsxs)(p.ck,{children:[(0,s.jsx)(p.Zr,{disabled:o,children:"Abbrechen"}),(0,s.jsx)(p.Rx,{onClick:c,disabled:o,className:"bg-red-600 hover:bg-red-700",children:o?"L\xf6schen...":"L\xf6schen"})]})]})})]})}function f({filter:e,searchQuery:n,reloadRef:r,onEdit:i,wohnungen:l}){let[a,o]=(0,t.useState)([]),[d,c]=(0,t.useState)([]),[u,m]=(0,t.useState)(!1),[x,f]=(0,t.useState)(null),[b,v]=(0,t.useState)(!1),w=async()=>{let e=await fetch("/api/mieter");e.ok&&o(await e.json())},k=(0,t.useMemo)(()=>{let e={};return l?.forEach(n=>{e[n.id]=n.name}),e},[l]);return(0,s.jsxs)("div",{className:"rounded-md border",children:[(0,s.jsxs)(h.XI,{children:[(0,s.jsx)(h.A0,{children:(0,s.jsxs)(h.Hj,{children:[(0,s.jsx)(h.nd,{className:"w-[250px]",children:"Name"}),(0,s.jsx)(h.nd,{children:"E-Mail"}),(0,s.jsx)(h.nd,{children:"Telefon"}),(0,s.jsx)(h.nd,{children:"Wohnung"}),(0,s.jsx)(h.nd,{children:"Nebenkosten"})]})}),(0,s.jsx)(h.BF,{children:0===d.length?(0,s.jsx)(h.Hj,{children:(0,s.jsx)(h.nA,{colSpan:5,className:"h-24 text-center",children:"Keine Mieter gefunden."})}):d.map(e=>(0,s.jsx)(g,{tenant:e,onEdit:()=>i?.(e),onRefresh:w,children:(0,s.jsxs)(h.Hj,{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>i?.(e),children:[(0,s.jsx)(h.nA,{className:"font-medium",children:e.name}),(0,s.jsx)(h.nA,{children:e.email}),(0,s.jsx)(h.nA,{children:e.telefonnummer}),(0,s.jsx)(h.nA,{children:e.wohnung_id&&k[e.wohnung_id]||"-"}),(0,s.jsx)(h.nA,{children:e.nebenkosten?.map(e=>`${e} €`).join(", ")||"-"})]})},e.id))})]}),(0,s.jsx)(p.Lt,{open:u,onOpenChange:m,children:(0,s.jsxs)(p.EO,{children:[(0,s.jsxs)(p.wd,{children:[(0,s.jsx)(p.r7,{children:"Sind Sie sicher?"}),(0,s.jsxs)(p.$v,{children:['Der Mieter "',x?.name,'" wird gel\xf6scht.']})]}),(0,s.jsxs)(p.ck,{children:[(0,s.jsx)(p.Zr,{disabled:b,children:"Abbrechen"}),(0,s.jsx)(p.Rx,{onClick:async()=>{if(!x)return;v(!0);let e=await fetch(`/api/mieter?id=${x.id}`,{method:"DELETE"});v(!1),m(!1),e.ok?((0,j.oR)({title:"Gel\xf6scht",description:"Mieter entfernt."}),w()):(0,j.oR)({title:"Fehler",description:"L\xf6schen fehlgeschlagen.",variant:"destructive"})},className:"bg-red-600 hover:bg-red-700",children:b?"L\xf6sche...":"L\xf6schen"})]})]})})]})}var b=r(37826),v=r(39390),w=r(63974);function k(){let[e,n]=(0,t.useState)("all"),[r,d]=(0,t.useState)(""),[h,u]=(0,t.useState)(!1),[m,x]=(0,t.useState)(null),[p,g]=(0,t.useState)({wohnung_id:"",name:"",einzug:"",auszug:"",email:"",telefonnummer:"",notiz:"",nebenkosten:"",nebenkosten_datum:""}),k=(0,t.useRef)(null),[N,z]=(0,t.useState)([]),M=e=>{u(e),e||(x(null),g({wohnung_id:"",name:"",einzug:"",auszug:"",email:"",telefonnummer:"",notiz:"",nebenkosten:"",nebenkosten_datum:""}))},C=e=>g({...p,[e.target.name]:e.target.value}),S=(0,t.useCallback)(e=>{x(e.id),g({wohnung_id:e.wohnung_id||"",name:e.name,einzug:e.einzug||"",auszug:e.auszug||"",email:e.email||"",telefonnummer:e.telefonnummer||"",notiz:e.notiz||"",nebenkosten:e.nebenkosten?.join(",")||"",nebenkosten_datum:e.nebenkosten_datum?.join(",")||""}),u(!0)},[]),_=async e=>{e.preventDefault();let{wohnung_id:n,name:r,einzug:s,auszug:t,email:i,telefonnummer:l,notiz:a,nebenkosten:o,nebenkosten_datum:d}=p,c={name:r};n&&(c.wohnung_id=n),s&&(c.einzug=s),t&&(c.auszug=t),i&&(c.email=i),l&&(c.telefonnummer=l),a&&(c.notiz=a),o.trim()&&(c.nebenkosten=o.split(",").map(e=>parseFloat(e.trim())).filter(e=>!isNaN(e))),d.trim()&&(c.nebenkosten_datum=d.split(",").map(e=>e.trim()).filter(e=>e));let h=m?`/api/mieter?id=${m}`:"/api/mieter",u=await fetch(h,{method:m?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(u.ok)(0,j.oR)({title:"Erfolgreich",description:"Mieter gespeichert."}),M(!1),k.current?.();else{let e=await u.json();console.error("POST /api/mieter error response:",e),(0,j.oR)({title:"Fehler beim Speichern",description:e.details||e.error||"Unbekannter Fehler",variant:"destructive"})}};return(0,s.jsxs)("div",{className:"flex flex-col gap-8 p-8",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Mieter"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Verwalten Sie Ihre Mieter und Mietverh\xe4ltnisse"})]}),(0,s.jsxs)(b.lG,{open:h,onOpenChange:M,children:[(0,s.jsx)(b.zM,{asChild:!0,children:(0,s.jsxs)(l.$,{className:"sm:w-auto",children:[(0,s.jsx)(a.A,{className:"mr-2 h-4 w-4"}),"Mieter hinzuf\xfcgen"]})}),(0,s.jsxs)(b.Cf,{className:"sm:max-w-[600px]",children:[(0,s.jsxs)(b.c7,{children:[(0,s.jsx)(b.L3,{children:m?"Mieter bearbeiten":"Mieter hinzuf\xfcgen"}),(0,s.jsx)(b.rr,{children:"F\xfcllen Sie alle Pflichtfelder aus."})]}),(0,s.jsxs)("form",{onSubmit:_,className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"wohnung_id",children:"Wohnung"}),(0,s.jsxs)(w.l6,{value:p.wohnung_id,onValueChange:e=>g({...p,wohnung_id:e}),children:[(0,s.jsx)(w.bq,{id:"wohnung_id",children:(0,s.jsx)(w.yv,{placeholder:"--"})}),(0,s.jsx)(w.gC,{children:N.map(e=>(0,s.jsx)(w.eb,{value:e.id,children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"name",children:"Name"}),(0,s.jsx)(o.p,{id:"name",name:"name",value:p.name,onChange:C,required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"einzug",children:"Einzug"}),(0,s.jsx)(o.p,{id:"einzug",name:"einzug",type:"date",value:p.einzug,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"auszug",children:"Auszug"}),(0,s.jsx)(o.p,{id:"auszug",name:"auszug",type:"date",value:p.auszug,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"email",children:"E-Mail"}),(0,s.jsx)(o.p,{id:"email",name:"email",type:"email",value:p.email,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"telefonnummer",children:"Telefon"}),(0,s.jsx)(o.p,{id:"telefonnummer",name:"telefonnummer",value:p.telefonnummer,onChange:C})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)(v.J,{htmlFor:"notiz",children:"Notiz"}),(0,s.jsx)(o.p,{id:"notiz",name:"notiz",value:p.notiz,onChange:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"nebenkosten",children:"Nebenkosten (€)"}),(0,s.jsx)(o.p,{id:"nebenkosten",name:"nebenkosten",value:p.nebenkosten,onChange:C,placeholder:"z.B. 25,30"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"nebenkosten_datum",children:"Nebenkosten Datum"}),(0,s.jsx)(o.p,{id:"nebenkosten_datum",name:"nebenkosten_datum",value:p.nebenkosten_datum,onChange:C,placeholder:"YYYY-MM-DD, ..."})]})]}),(0,s.jsx)(b.Es,{children:(0,s.jsx)(l.$,{type:"submit",children:"Speichern"})})]})]})]})]}),(0,s.jsxs)(i.Zp,{className:"overflow-hidden rounded-xl border-none shadow-md",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Mieterverwaltung"}),(0,s.jsx)(i.BT,{children:"Hier k\xf6nnen Sie Ihre Mieter verwalten und filtern"})]}),(0,s.jsxs)(i.Wu,{className:"flex flex-col gap-6",children:[(0,s.jsx)(c,{onFilterChange:n,onSearchChange:d}),(0,s.jsx)(f,{filter:e,searchQuery:r,reloadRef:k,onEdit:S,wohnungen:N})]})]})]})}r(38398)},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},40300:(e,n,r)=>{Promise.resolve().then(r.bind(r,15264))},53452:(e,n,r)=>{Promise.resolve().then(r.bind(r,94340))},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},86222:(e,n,r)=>{"use strict";r.r(n),r.d(n,{GlobalError:()=>l.a,__next_app__:()=>h,pages:()=>c,routeModule:()=>u,tree:()=>d});var s=r(65239),t=r(48088),i=r(88170),l=r.n(i),a=r(30893),o={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>a[e]);r.d(n,o);let d={children:["",{children:["(dashboard)",{children:["mieter",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,94340)),"/Users/felixplant/Downloads/Felix/GitHub-Repo/RMS/app/(dashboard)/mieter/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,71934)),"/Users/felixplant/Downloads/Felix/GitHub-Repo/RMS/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"/Users/felixplant/Downloads/Felix/GitHub-Repo/RMS/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/Users/felixplant/Downloads/Felix/GitHub-Repo/RMS/app/(dashboard)/mieter/page.tsx"],h={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:t.RouteKind.APP_PAGE,page:"/(dashboard)/mieter/page",pathname:"/mieter",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},94340:(e,n,r)=>{"use strict";r.r(n),r.d(n,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/felixplant/Downloads/Felix/GitHub-Repo/RMS/app/(dashboard)/mieter/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/felixplant/Downloads/Felix/GitHub-Repo/RMS/app/(dashboard)/mieter/page.tsx","default")}};var n=require("../../../webpack-runtime.js");n.C(e);var r=e=>n(n.s=e),s=n.X(0,[524,768,700,814,575,108,209,697,232,709],()=>r(86222));module.exports=s})();